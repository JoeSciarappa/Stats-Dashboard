{% extends "outline.html" %}

{% block head %}

<style>
table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
}

td, th {
    border: 1px solid #dddddd;
    text-align: center;
    padding: 8px;
}

tr:nth-child(even) {
    background-color: #dddddd;
}
</style>

{% endblock %}

{% block jscript %}


function CallsPerTeam() {
	$.getJSON('CallsPerTeam', function(jp)  {

		WatchdogsCallsPerTeam = jp.watchdogs
		SpattlecockCallsPerTeam = jp.spattlecock
		PorkchopExpressCallsPerTeam = jp.porkchopexpress

	$('#CallsPerTeam').highcharts({
		chart: {
			plotBackgroundColor: null,
			plotBorderWidth: null,
			plotShadow: false,
			type: 'pie'
		},
		title: {
			text: 'Percent calls by team'
		},
		tooltip: {
			pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
		},
		plotOptions: {
			pie: {
				allowPointSelect: true,
				cursor: 'pointer',
				dataLabels: {
					enabled: true,
					format: '<b>{point.name}</b>: {point.percentage:.1f} %',
					style: {
						color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
					}
				}
			}
		},
		series: [{
			name: 'Teams',
			colorByPoint: true,
			data: [{
				name: 'Watchdogs',
				y: WatchdogsCallsPerTeam,
				color: "#5D6D7E"
			}, {
				name: 'Spattlecock',
				y: SpattlecockCallsPerTeam,
				color: "#785A66"
			},{
				name: 'Porkchop Express',
				y: PorkchopExpressCallsPerTeam,
				color: "#B7DCD8"

			}]
		}]
	});
	});
};

function PublicTicketsPerTeam() {
        $.getJSON('PublicTicketsPerTeam', function(jp)  {

                WatchdogsTicketsPerTeam = jp.watchdogs
                SpattlecockTicketsPerTeam = jp.spattlecock
                PorkchopExpressTicketsPerTeam = jp.porkchopexpress

        $('#PublicTicketsPerTeam').highcharts({
                chart: {
                        plotBackgroundColor: null,
                        plotBorderWidth: null,
                        plotShadow: false,
                        type: 'pie'
                },
                title: {
                        text: 'Percent public tickets per team'
                },
                tooltip: {
                        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                        pie: {
                                allowPointSelect: true,
                                cursor: 'pointer',
                                dataLabels: {
                                        enabled: true,
                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                                        style: {
                                                color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                                        }
                                }
                        }
                },
                series: [{
                        name: 'Teams',
                        colorByPoint: true,
                        data: [{
                                name: 'Watchdogs',
                                y: WatchdogsTicketsPerTeam,
				color: "#5D6D7E"
                        }, {
                                name: 'Spattlecock',
                                y: SpattlecockTicketsPerTeam,
				color: "#785A66"
                        },{
                                name: 'Porkchop Express',
                                y: PorkchopExpressTicketsPerTeam,
				color: "#B7DCD8"
                        }]
                }]
        });
        });
};

function CallsPerLevel() {
        $.getJSON('CallsPerLevel', function(jp)  {

                l1Calls = jp.l1
                l2Calls = jp.l2

        $('#CallsPerLevel').highcharts({
                chart: {
                        plotBackgroundColor: null,
                        plotBorderWidth: null,
                        plotShadow: false,
                        type: 'pie'
                },
                title: {
                        text: 'Percent calls per level'
                },
                tooltip: {
                        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                        pie: {
                                allowPointSelect: true,
                                cursor: 'pointer',
                                dataLabels: {
                                        enabled: true,
                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                                        style: {
                                                color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                                        }
                                }
                        }
                },
                series: [{
                        name: 'Teams',
                        colorByPoint: true,
                        data: [{
                                name: 'Level 1',
				color: '#588C7E',
                                y: l1Calls
                        }, {
                                name: 'Level 2',
				color: '#004f99',
                                y: l2Calls
                        }]
                }]
        });
        });
};

function PublicTicketsPerLevel() {
        $.getJSON('PublicTicketsPerLevel', function(jp)  {

                l1Tickets = jp.l1
                l2Tickets = jp.l2

        $('#PublicTicketsPerLevel').highcharts({
                chart: {
                        plotBackgroundColor: null,
                        plotBorderWidth: null,
                        plotShadow: false,
                        type: 'pie'
                },
                title: {
                        text: 'Percent public ticket per level'
                },
                tooltip: {
                        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                        pie: {
                                allowPointSelect: true,
                                cursor: 'pointer',
                                dataLabels: {
                                        enabled: true,
                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                                        style: {
                                                color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                                        }
                                }
                        }
                },
                series: [{
                        name: 'Teams',
                        colorByPoint: true,
                        data: [{
                                name: 'Level 1',
				color: '#588C7E',
                                y: l1Tickets
                        }, {
                                name: 'Level 2',
				color: '#004f99',
                                y: l2Tickets
                        }]
                }]
        });
        });
};

function TicketBarGraph() {
	$.getJSON('TicketBarGraph', function(jp)  {
		rackerData = jp.TicketBarGraph	
 
	$('#TicketBarGraph').highcharts({
		chart: {
			type: 'column'
		},
		title: {
			text: 'Ticket Count By Racker'
		},
		subtitle: {
			text: 'sum of public updates for dedicated and cloud tickets'
		},
		xAxis: {
			type: 'category',
			labels: {
				rotation: -45,
				style: {
					fontSize: '13px',
					fontFamily: 'Verdana, sans-serif'
				}
			}
		},
		yAxis: {
			min: 0,
			title: {
				text: 'Public Ticket Updates'
			}
		},
		legend: {
			enabled: false
		},
		series: [{
			name: 'Public Updates',
			data: 

			rackerData
	
			,
			dataLabels: {
				enabled: true,
				rotation: -90,
				color: '#FFFFFF',
				align: 'right',
				format: '{point.y}',
				y: 10, // 10 pixels down from the top
				style: {
					fontSize: '13px',
					fontFamily: 'Verdana, sans-serif'
				}
			}
		}]
	});
        });
};

function CallBarGraph() {
	$.getJSON('CallBarGraph', function(jp)  {
		rackerData = jp.CallBarGraph		
 
	$('#CallBarGraph').highcharts({
		chart: {
			type: 'column'
		},
		title: {
			text: 'Call Count By Racker'
		},
		subtitle: {
			text: 'number of calls each Racker fielded'
		},
		xAxis: {
			type: 'category',
			labels: {
				rotation: -45,
				style: {
					fontSize: '13px',
					fontFamily: 'Verdana, sans-serif'
				}
			}
		},
		yAxis: {
			min: 0,
			title: {
				text: 'Calls'
			}
		},
		legend: {
			enabled: false
		},
		series: [{
			name: 'Calls',
			data: 

			rackerData
	
			,
			dataLabels: {
				enabled: true,
				rotation: -90,
				color: '#FFFFFF',
				align: 'right',
				format: '{point.y}',
				y: 10, // 10 pixels down from the top
				style: {
					fontSize: '13px',
					fontFamily: 'Verdana, sans-serif'
				}
			}
		}]
	});
        });
};

function CallLeaderboard() {

	$.getJSON('CallLeaderboard', function(jp)  {
		leader1Name = jp.leader1Name
                leader1Calls = jp.leader1Calls 
		leader1Team = jp.leader1Team

		leader2Name = jp.leader2Name
		leader2Calls = jp.leader2Calls
		leader2Team = jp.leader2Team

		leader3Name = jp.leader3Name
		leader3Calls = jp.leader3Calls
		leader3Team = jp.leader3Team

		$("#1callname").html(leader1Name);
		$("#1calls").html(leader1Calls);
		$("#1callteam").html(leader1Team);

		$("#2callname").html(leader2Name);
		$("#2calls").html(leader2Calls);
		$("#2callteam").html(leader2Team);

		$("#3callname").html(leader3Name);
		$("#3calls").html(leader3Calls);
		$("#3callteam").html(leader3Team);

	});

};

function TicketLeaderboard() {

        $.getJSON('TicketLeaderboard', function(jp)  {
                leader1Name = jp.leader1Name
                leader1Tickets = jp.leader1Tickets
                leader1Team = jp.leader1Team

                leader2Name = jp.leader2Name
                leader2Tickets = jp.leader2Tickets
                leader2Team = jp.leader2Team

                leader3Name = jp.leader3Name
                leader3Tickets = jp.leader3Tickets
                leader3Team = jp.leader3Team

                $("#1ticketname").html(leader1Name);
                $("#1tickets").html(leader1Tickets);
                $("#1ticketteam").html(leader1Team);

                $("#2ticketname").html(leader2Name);
                $("#2tickets").html(leader2Tickets);
                $("#2ticketteam").html(leader2Team);

                $("#3ticketname").html(leader3Name);
                $("#3tickets").html(leader3Tickets);
                $("#3ticketteam").html(leader3Team);

        });

};

function AverageTicketsPerRackerPerTeam() {
        $.getJSON('AverageTicketsPerRackerPerTeam', function(jp)  {
                rackerData = jp.atprpt

        $('#atprpt').highcharts({
                chart: {
                        type: 'column'
                },
                title: {
                        text: 'Average Tickets Per Racker Per Team'
                },
                subtitle: {
                        text: 'the average number of tickets each Racker took per team'
                },
                xAxis: {
                        type: 'category',
                        labels: {
                                rotation: -45,
                                style: {
                                        fontSize: '13px',
                                        fontFamily: 'Verdana, sans-serif'
                                }
                        }
                },
                yAxis: {
                        min: 0,
                        title: {
                                text: 'Average Tickets'
                        }
                },
                legend: {
                        enabled: false
                },
                series: [{
                        name: 'Average Tickets',
                        data:

                        rackerData

                        ,
                        dataLabels: {
                                enabled: true,
                                rotation: -90,
                                color: '#FFFFFF',
                                align: 'right',
                                format: '{point.y}',
                                y: 10, // 10 pixels down from the top
                                style: {
                                        fontSize: '13px',
                                        fontFamily: 'Verdana, sans-serif'
                                }
                        }
                }]
        });
        });
};

function AverageCallsPerRackerPerTeam() {
        $.getJSON('AverageCallsPerRackerPerTeam', function(jp)  {
                rackerData = jp.acprpt

        $('#acprpt').highcharts({
                chart: {
                        type: 'column'
                },
                title: {
                        text: 'Average Calls Per Racker Per Team'
                },
                subtitle: {
                        text: 'the average number of calls each Racker took per team'
                },
                xAxis: {
                        type: 'category',
                        labels: {
                                rotation: -45,
                                style: {
                                        fontSize: '13px',
                                        fontFamily: 'Verdana, sans-serif'
                                }
                        }
                },
                yAxis: {
                        min: 0,
                        title: {
                                text: 'Calls'
                        }
                },
                legend: {
                        enabled: false
                },
                series: [{
                        name: 'Average Calls',
                        data:

                        rackerData

                        ,
                        dataLabels: {
                                enabled: true,
                                rotation: -90,
                                color: '#FFFFFF',
                                align: 'right',
                                format: '{point.y}',
                                y: 10, // 10 pixels down from the top
                                style: {
                                        fontSize: '13px',
                                        fontFamily: 'Verdana, sans-serif'
                                }
                        }
                }]
        });
        });
};


CallLeaderboard();
TicketLeaderboard();
CallBarGraph();
TicketBarGraph();
CallsPerTeam();
PublicTicketsPerTeam();
CallsPerLevel();
PublicTicketsPerLevel();
AverageTicketsPerRackerPerTeam();
AverageCallsPerRackerPerTeam();

setInterval(function(){
	CallLeaderboard();
	TicketLeaderboard();
	CallBarGraph();
	TicketBarGraph();
	AverageTicketsPerRackerPerTeam();
	AverageCallsPerRackerPerTeam();
	CallsPerTeam();
	PublicTicketsPerTeam();
	CallsPerLevel();
	PublicTicketsPerLevel();
}, 70000);

{% endblock %}


{% block content %}
<div id="container" style="padding-left: 5%; padding-top: 1%;padding-right: 5%;width:100%;height:100%"> 

		<h1 style="text-align: center"> SMB Linux Stats</h1>
{% if ifrow == 0 %}
	<div id="noRecords" style="padding-top: 3%;"> <p align="center"> No records to display for today </p> </div>
{% endif %}

{% if ifrow != 0 %}

<div id="leaderboard" style="display:table;width:100%;height:100%; padding-top: 5%">

	
		<div style="width:48%;display:table;float:left">

		 <p style="text-align: center;font-size: 125%"> Phone Leaderboard</p>
		<table style="margin: 0 auto;">
		<tr><th>Name</th><th>Calls</th><th>Team</th></tr>
		<tr><td id="1callname"></td><td id="1calls"></td><td id="1callteam"></td></tr>		
		<tr><td id="2callname"></td><td id="2calls"></td><td id="2callteam"></td></tr> 
		<tr><td id="3callname"></td><td id="3calls"></td><td id="3callteam"></td></tr>
               </table>
		</div>

                <div style="width:48%;display:table;float:right">
                <p style="text-align: center;font-size: 125%"> Ticket Leaderboard</p>
                <table style="margin: 0 auto;"> 
                <tr><th>Name</th><th>Tickets</th><th>Team</th></tr>
                <tr><td id="1ticketname"></td><td id="1tickets"></td><td id="1ticketteam"></td></tr>
                <tr><td id="2ticketname"></td><td id="2tickets"></td><td id="2ticketteam"></td></tr>
                <tr><td id="3ticketname"></td><td id="3tickets"></td><td id="3ticketteam"></td></tr>
               </table>
		</div>


</div>
<div style="padding-top:3%">

	<div id="CallBarGraph" > </div>
	<div id="TicketBarGraph"> </div>
</div>
<div style="padding-top:3%">

        <div id="acprpt" style="width:48%;float:left;"> </div>
        <div id="atprpt" style="width:48%;float:right;"> </div>




	<div id="CallsPerTeam" style="padding-top:3%;width:49%;float:left"> </div>
	<div id="PublicTicketsPerTeam" style="padding-top:3%;width:49%;float:right"> </div>


	<div id="CallsPerLevel" style="padding-top:5%;width:49%;float:left"> </div>
	<div id="PublicTicketsPerLevel" style="padding-top:5%;width:49%;float:right"> </div>

</div>

{% endif %}

</div> <!-- end container div -->

{% endblock %}

